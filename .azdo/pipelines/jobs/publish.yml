parameters:
- name: Version
- name: VersionSuffix

steps:
  - task: UseDotNet@2
    displayName: 'Use .NET SDK'
    inputs:
      version: ${{ variables.DotNetVersion }}

  - task: DotNetCoreCLI@2
    inputs:
      command: publish
      arguments: '--configuration Release --output "$(Build.ArtifactStagingDirectory)/${{ variables.PackageArtifactName }}/${{ parameters.Version }}" --no-build --version-suffix ${{ parameters.VersionSuffix }}'
      projects: ${{ variables.SourceProjectsString }}
      publishWebProjects: false
      modifyOutputPath: false
      zipAfterPublish: false

  - task: PublishPipelineArtifact@1
    displayName: Publish Package Artifact
    inputs:
      targetPath: "$(Build.ArtifactStagingDirectory)/${{ variables.PackageArtifactName }}/${{ parameters.Version }}"
      artifactName: ${{ variables.PackageArtifactName }}
      artifactType: 'pipeline'
